<!--index.wxml-->
<!-- é¦–é¡µ - å…¨æ–°è®¾è®¡ -->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="top-header">
    <view class="header-content">
      <view class="user-info" bindtap="handleUserClick">
        <view class="user-avatar-wrapper">
          <text class="user-avatar-text">{{userInfo.username ? userInfo.username.substring(0,1) : 'æ¸¸'}}</text>
        </view>
        <view class="user-text">
          <text class="greeting">{{greetingTime}}</text>
          <text class="username">{{userInfo.username || 'æ¸¸å®¢'}}</text>
        </view>
      </view>
      <view class="header-buttons">
        <button class="icon-btn settings-btn" bindtap="deviceSettings">
          <text class="icon-text">âš™</text>
        </button>
      </view>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- è®¾å¤‡çŠ¶æ€å¡ç‰‡ -->
    <view wx:if="{{connectedDevice}}" class="device-card">
      <view class="device-header">
        <view class="device-info">
          <text class="device-name">{{connectedDevice.deviceName || 'æ™ºèƒ½çœ¼é•œ Pro'}}</text>
          <text class="device-model">å‹å·: {{connectedDevice.model || 'æœªçŸ¥'}}</text>
        </view>
        <view class="connection-status">
          <view class="status-indicator {{isConnecting ? 'connecting' : 'connected'}}"></view>
          <text class="status-text">{{isConnecting ? 'è¿æ¥ä¸­...' : 'å·²è¿æ¥'}}</text>
        </view>
      </view>
      
      <view class="device-status">
        <view class="status-card battery-card">
          <view class="status-header">
            <text class="status-icon">ğŸ”‹</text>
            <text class="status-value">{{deviceBattery || 85}}%</text>
          </view>
          <view class="battery-bar-container">
            <view class="battery-bar" style="width: {{deviceBattery || 85}}%"></view>
          </view>
          <text class="status-label">{{deviceBattery >= 80 ? 'ç”µé‡å……è¶³' : deviceBattery >= 20 ? 'ç”µé‡æ­£å¸¸' : 'ç”µé‡è¾ƒä½'}}</text>
        </view>
        
        <view class="status-card mode-card">
          <view class="status-header">
            <text class="status-icon">âœ¨</text>
            <text class="status-value">AIæ¨¡å¼</text>
          </view>
          <text class="status-detail">GPT-4</text>
          <text class="status-label">{{aiModeEnabled ? 'å·²å¯ç”¨' : 'è¿è¡Œæ­£å¸¸'}}</text>
        </view>
      </view>
      
      <view class="control-buttons">
        <button class="control-btn power-btn" bindtap="shutdownDevice">
          <text class="btn-icon">â»</text>
          <text class="btn-text">æ–­å¼€è¿æ¥</text>
        </button>
        <button class="control-btn ai-btn {{aiModeEnabled ? 'active' : ''}}" bindtap="toggleAiMode">
          <text class="btn-icon">ğŸ§ </text>
          <text class="btn-text">{{aiModeEnabled ? 'AIå¢å¼º' : 'å¼€å¯AI'}}</text>
        </button>
      </view>
    </view>

    <!-- æ— è®¾å¤‡è¿æ¥çŠ¶æ€ -->
    <view wx:else class="no-device-section">
      <text class="no-device-icon">ğŸ”</text>
      <text class="no-device-title">æš‚æ— è®¾å¤‡è¿æ¥</text>
      <text class="no-device-subtitle">è¯·æ·»åŠ æ‚¨çš„æ™ºèƒ½çœ¼é•œè®¾å¤‡</text>
      <button class="add-device-from-empty" bindtap="addDevice">
        <text class="btn-icon">+</text>
        <text class="btn-text">æ·»åŠ è®¾å¤‡</text>
      </button>
    </view>

    <!-- å¿«é€ŸåŠŸèƒ½å…¥å£ -->
    <view class="quick-actions">
      <text class="section-title">å¿«é€Ÿè®¾ç½®</text>
      
      <view class="action-grid">
        <view class="action-item" bindtap="switchAIModel">
          <view class="action-icon-wrapper primary-bg">
            <text class="action-icon">ğŸ§ </text>
          </view>
          <text class="action-name">AIæ¨¡å‹</text>
          <text class="action-desc">ç®¡ç†æ™ºèƒ½æ¨¡å‹</text>
        </view>
        
        <view class="action-item" bindtap="soundSettings">
          <view class="action-icon-wrapper secondary-bg">
            <text class="action-icon">ğŸµ</text>
          </view>
          <text class="action-name">éŸ³æ•ˆè®¾ç½®</text>
          <text class="action-desc">è‡ªå®šä¹‰éŸ³æ•ˆ</text>
        </view>
        
        <view class="action-item" bindtap="extensionFunctions">
          <view class="action-icon-wrapper warning-bg">
            <text class="action-icon">ğŸ§©</text>
          </view>
          <text class="action-name">åŠŸèƒ½ç»„ä»¶</text>
          <text class="action-desc">æ‰©å±•åŠŸèƒ½</text>
        </view>
        
        <view class="action-item" bindtap="volumeControl">
          <view class="action-icon-wrapper info-bg">
            <text class="action-icon">ğŸ”Š</text>
          </view>
          <text class="action-name">éŸ³é‡æ§åˆ¶</text>
          <text class="action-desc">è°ƒèŠ‚éŸ³é‡</text>
        </view>
      </view>
    </view>
  </view>
</view>
