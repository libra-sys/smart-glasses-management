<!--model.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="header">
    <text class="page-title">åŠŸèƒ½ç»„ä»¶</text>
  </view>

  <!-- æ ‡ç­¾é¡µ -->
  <view class="tabs">
    <view 
      class="tab {{activeTab === 'installed' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="installed"
    >
      <text>å·²å®‰è£…</text>
    </view>
    <view 
      class="tab {{activeTab === 'recommended' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="recommended"
    >
      <text>æ¨è</text>
    </view>
    <view 
      class="tab {{activeTab === 'community' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="community"
    >
      <text>ç¤¾åŒº</text>
    </view>
  </view>

  <!-- å·²å®‰è£…ç»„ä»¶ -->
  <view class="section" wx:if="{{activeTab === 'installed'}}">
    <view class="section-header">
      <view class="section-icon">ğŸ“¦</view>
      <text class="section-title">å·²å®‰è£…</text>
    </view>
    
    <view class="component-list">
      <view wx:for="{{installedComponents}}" wx:key="id" class="component-item">
        <view class="component-icon" style="background-color: {{item.color}};">
          <text class="icon-emoji">{{item.icon}}</text>
        </view>
        <view class="component-info">
          <text class="component-name">{{item.name}}</text>
          <text class="component-desc">{{item.description}}</text>
        </view>
        <switch 
          checked="{{item.enabled}}" 
          bindchange="toggleInstalledComponent"
          data-index="{{index}}"
          class="component-switch"
        />
      </view>
    </view>
  </view>

  <!-- æ¨èç»„ä»¶ -->
  <view class="section" wx:if="{{activeTab === 'recommended'}}">
    <view class="section-header">
      <view class="section-icon">â­</view>
      <text class="section-title">æ¨èç»„ä»¶</text>
    </view>
    
    <view class="component-list">
      <view wx:for="{{recommendedComponents}}" wx:key="id" class="component-item recommended">
        <view class="component-icon" style="background-color: {{item.color}};">
          <text class="icon-emoji">{{item.icon}}</text>
        </view>
        <view class="component-info">
          <text class="component-name">{{item.name}}</text>
          <text class="component-desc">{{item.description}}</text>
        </view>
        <button 
          class="install-btn"
          bindtap="installComponent"
          data-component="{{item}}"
          data-source="recommended"
        >
          å®‰è£…
        </button>
      </view>
    </view>
  </view>

  <!-- ç¤¾åŒºç»„ä»¶ -->
  <view class="section" wx:if="{{activeTab === 'community'}}">
    <view class="section-header">
      <view class="section-icon">ğŸŒ</view>
      <text class="section-title">ç¤¾åŒºç»„ä»¶</text>
      <text class="section-subtitle">æ¥è‡ª http://localhost:5175</text>
    </view>
    
    <view class="component-list">
      <view 
        wx:for="{{communityComponents}}" 
        wx:key="id" 
        class="component-item community"
        bindtap="viewComponentDetail"
        data-component="{{item}}"
      >
        <view class="component-icon" style="background-color: {{item.color}};">
          <text class="icon-emoji">{{item.icon}}</text>
        </view>
        <view class="component-info">
          <text class="component-name">{{item.name}}</text>
          <text class="component-desc">{{item.description}}</text>
          <view class="component-meta">
            <text class="meta-item">ğŸ‘¤ {{item.author}}</text>
            <text class="meta-item">ğŸ“¥ {{item.downloads}}</text>
            <text class="meta-item">v{{item.version}}</text>
          </view>
        </view>
        <button 
          wx:if="{{!item.installed}}"
          class="install-btn"
          bindtap="installComponent"
          catchtap="stopPropagation"
          data-component="{{item}}"
          data-source="community"
        >
          å®‰è£…
        </button>
        <view wx:else class="installed-badge">âœ” å·²å®‰è£…</view>
      </view>
      
      <view wx:if="{{communityComponents.length === 0}}" class="empty-state">
        <text class="empty-icon">ğŸ“¦</text>
        <text class="empty-text">æš‚æ— ç¤¾åŒºç»„ä»¶</text>
        <text class="empty-hint">è¯·ç¡®è®¤ç½‘ç«™æœåŠ¡å™¨å·²å¯åŠ¨</text>
      </view>
    </view>
  </view>
</view>